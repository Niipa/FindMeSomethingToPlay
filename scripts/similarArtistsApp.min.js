var artistsApp=angular.module("similarArtistsApp",["ui.bootstrap","ngAnimate"]);artistsApp.controller("appCtrl",["$scope","$window","Artist",function(t,i,s){t.displayList=null,t.oneAtATime=!0,t.ttHelp=!1,t.onArtistSeedEnter=function(i){t.displayList=s.update(i),t.status=s.getSwitchSystemForAccordion(),t.ttHelp=!0},t.openInNewTab=function(t){i.open(t,"_blank")}}]),angular.module("similarArtistsApp").factory("lastFM",["$http",function(t){var i="http://ws.audioscrobbler.com/2.0/",s="&api_key=9934cbfa947e071d88273213df68ec4c";return{artist_getSimilarArtist:function(e,r){"undefined"!=typeof e.seedArtist&&t({method:"JSONP",url:i+"?method=artist.getSimilar&format=json&callback=JSON_CALLBACK&autocorrect=1&limit=6&artist="+encodeURIComponent(e.seedArtist)+s,cache:!0}).then(function(t){r(t.data)},function(t){r(t.data||"Request failed")})},artist_getTopTracks:function(e,r){"undefined"!=typeof e.seedArtist&&t({method:"JSONP",url:i+"?method=artist.getTopTracks&format=json&callback=JSON_CALLBACK&autocorrect=1&limit=6&artist="+encodeURIComponent(e.seedArtist)+s,cache:!0}).then(function(t){r(t.data)},function(t){r(t.data||"Request failed")})}}}]),angular.module("similarArtistsApp").factory("Artist",["lastFM",function(t){var i={},s={},e={seedArtist:"",similarArtists:[]};return e.getMap=function(){return i},e.clearMap=function(){i={}},e.getSwitchSystemForAccordion=function(){return s},e.clearSwitchSystem=function(){s={}},e.update=function(i){return this.seedArtist!==i?(this.seedArtist=i,this.similarArtists=[],this.clearMap(),this.clearSwitchSystem(),t.artist_getSimilarArtist({seedArtist:this.seedArtist},function(i){var s=i.similarartists;if("undefined"!=typeof s&&"undefined"!=typeof s.artist){s=s.artist||void 0;for(var e=0,r=0;e<s.length;++e){var a=s[e];this.similarArtists.push(a),this.getSwitchSystemForAccordion()[a.name]=!1,this.getMap()[a.name]=r,r++,t.artist_getTopTracks({seedArtist:a.name},function(t){var i=t.toptracks.track,s=t.toptracks["@attr"].artist;if(i&&s){var e=this.getMap();this.similarArtists[e[s]].toptracks=i}}.bind(this))}}}.bind(this)),this.similarArtists):void 0},e}]);
